# Compose - Phases

다른 UI 툴킷과 마찬가지로, Compose는 여러 단계를 거쳐 프레임을 렌더링합니다.  
`Android View`시스템을 보면, 측정(Measure), 레이아웃(Layout), 그리기(Drawing)의 세 가지 주요 단계가 있습니다.   
Compose는 유사하게, 시작 부분에 구성(Composition)이라는 중요한 단계가 있습니다.

---

## Frame의 세 가지 단계

Compose는 세 가지 주요 단계를 가집니다.

| 단계              | 요약              | 설명                                                                                                       |
|-----------------|-----------------|----------------------------------------------------------------------------------------------------------|
| 구성(Composition) | 어떤 UI를 보여줄 것인가  | Compose는 Composable을 실행하고 UI의 설명을 생성합니다.                                                                 |
| 레이아웃(Layout)    | UI를 어디에 배치할 것인가 | 이 단계는 측정과 배치라는 두 단계로 이루어져 있습니다. 레이아웃 요소는 자신과 모든 하위 요소를 2D 좌표로 측정하고 배치합니다. 이 과정은 레이아웃 트리의 각 노드에 대해 수행됩니다. |
| 그리기(Drawing)    | 어떻게 렌더링할 것인가    | UI 요소는 보통 기기 화면인 캔버스에 그려집니다. 각 UI 요소는 캔버스에 그리는 명령을 발행하며, 이는 그래픽 드라이버가 해석하여 화면에 렌더링 됩니다.                  |

<img src="../../resource/phases-3-phases.png" width="30%" height="30%">

위 단계들의 순서는 대게 동일하며, `Data 입력 → Composition → Layout → Drawing` 으로 이어져 하나의 `프레임(Frame)`을 생성합니다.
이것을 [UDF](../용어.md#단방향-데이터-흐름) 라고도 합니다.  
`BoxWithConstraints`, `LazyColumn` 및 `LazyRow` 등은 예외적인 경우로 개발자들의 확인이 필요합니다.  
이들의 경우, 자식 요소의 구성(Composition)은 부모 요소의 레이아웃(Layout) 단계에 따라 달라집니다.

위 세 단계는 거의 모든 프레임에 대해 가상으로 이루어진다고 생각하면 됩니다.  
그러나 성능 최적화를 위해, Compose는 동일한 데이터 입력에서 동일한 결과를 도출하는 반복 작업을 하지 않습니다.   
Compose는 이전 결과를 재사용 할 수 있는 경우에는 Composable을 실행하지 않고, 전체 트리를 다시 레이아웃(Layout)하거나 그릴(Drawing) 필요가 없는 경우 생략합니다.

따라서 Compose는 UI 업데이트에 필요한 최소한의 작업만 수행하게 됩니다. 이러한 최적화는 Compose가 각 단계에서의 상태 변화를 추적하기 때문에 가능한 것입니다.