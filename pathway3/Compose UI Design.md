# Compose UI 설계
- Compose의 UI는 변경 불가(UI를 설계한 후 업데이트가 불가능함)
- 대신 UI의 상태는 제어가 가능
- → UI 상태가 변경될 때마다 Compose는 변경된 UI 트리 부분을 다시 만듦
- 컴포저블은 상태를 수락하고 이벤트를 노출할 수 있음
- 예를 들어 `TextField`는 값을 수락하고 콜백 `onValueChange`를 노출함. 이 콜백은 값을 변경하기 위해 콜백 핸들러를 요청함

<br>

### Compose에서 단방향 데이터 흐름 패턴을 구현하는 방법
- `단방향 데이터 흐름(UDF)`
  - 상태는 아래로 이동하고, 이벤트는 위로 이동하는 디자인 패턴
  - 단방향 데이터 흐름을 따라 UI에 상태를 표시하는 컴포저블과 상태를 저장하고 변경하는 앱 부분을 서로 분리할 수 있음
- 단방향 데이터 흐름을 사용하는 앱의 UI 업데이트 루프<br>
  <image width = 200 height=200 src = "https://user-images.githubusercontent.com/101886039/205633244-3a2b5d13-2888-4d91-aa65-efde37f86bea.png">
    - `이벤트`: UI의 일부가 이벤트를 생성하여 위쪽으로 전달하거나 앱의 다른 레이어에서 이벤트가 전달
    - `상태 업데이트`: 이벤트 핸들러가 상태를 변경 가능
    - `상태 표시`: 상태 홀더가 상태를 아래로 전달하고 UI가 상태를 표시함
- 단방향 데이터 흐름 패턴의 이점
  - `테스트 가능성`: 상태와 상태를 표시하는 UI를 분리해 격리 상태에서 더 쉽게 테스트 가능
  - `상태 캡슐화`: 상태는 한 곳에서만 업데이트할 수 있고, 컴포저블의 상태에 관한 정보 소스가 하나뿐이므로 일관되지 않은 상태로 인해 버그를 만들 가능성이 적다
  - `UI 일관성`: 관찰 가능한 상태 홀더(`StateFlow`, `LiveDate`)를 사용함으로써 모든 상태 업데이트가 UI에 즉시 반영
- 컴포저블 매개변수 정의
  - 고려 사항
    - 컴포저블의 재사용 가능성 또는 유연성
    - 상태 매개변수가 컴포저블의 성능에 미치는 영향
  - 전달하는 매개변수의 수를 신중하게 고려해야 함
    - 함수에 매개변수가 너무 많으면 함수의 인체공학적 특성이 감소하므로 매개변수를 클래스로 그룹화하는 것이 좋음

<br>

### 이벤트 및 상태 홀더를 구현하는 방법
- Compose의 이벤트
  - 이벤트에 의해 UI 상태가 변경되므로 ViewModel이 이벤트를 처리하고 UI 상태를 업데이트해야 함
  - UI 레이어가 이벤트 핸들러 외부에서 상태 변경하면 안됨
  - 상태 및 이벤트 핸들러 람다에 변경할 수 없는 값을 전달하는것이 좋음
    - 재사용 가능성 개선
    - UI가 상태의 값을 직접 변경하지 않아도 됨
    - 상태가 다른 스레드에서 변경되지 않기 때문에 동시 실행 문제 발생하지 않음
    - 보통 코드 복잡성이 감소함
<br>

### Compose에서 ViewModel을 사용하는 방법
- ViewModel, 상태 및 이벤트
  - UI의 상태는 관찰 가능한 상태홀더를 통해 노출됨
  - ViewModel은 앱의 UI또는 다른 레이어에서 발생하는 이벤트를 처리하고 이벤트를 기반으로 상태 홀더를 업데이트
  - 위 두가지의 경우 중 하나라도 해당하면 ViewModel, mutableStateOf를 사용해 앱에 단방향 데이터 흐름 도입 가능

<br>
